# Описание проекта

Этот проект предназначен для обработки видеофайлов и отправки их через WebSocket на сервер. В проекте используются библиотеки OpenCV, PyAV и Socket.IO для обработки видео и взаимодействия с сервером.

## Установка и настройка
Установка зависимостей

```bash
pip install -r requirements.txt
```

### Переменные окружения

Файл `.env` содержит следующие переменные окружения:

```
host_socker_url=<URL вашего сервера Socket.IO>
socker_path=<Путь к Socket.IO>
host_url=<Путь к развернутому бэкенду на сервере>
```
Сейчас `.env` актуален для развернутого решения на сервере Ромы.

### Структура проекта

```
.
├── test_model                   # Директория с файлами для тестирования API модели распознавания
├───── videos                    # Директория с видеофайлами
├───── main.py                   # Основной файл скрипта тестирования API
├───── questions_and_gloss.txt   # Файл со списком вопросов и глоссов на эти вопросы, видео с этими глоссами должен записать Павел
├── test_vector_find             # Директория с файлами для тестирования векторного поиска
├───── queries.txt               # Файл со списком вопросов и путями до пунктов инструкций
├───── test_vector_find.py       # Основной файл скрипта тестирования векторного поиска
├── .env                         # Файл с переменными окружения
├── README.md                    # Файл с описанием проекта
└── requirements.txt             # Файл зависимостей
```

## Использование

### Тестирование API модели распознавания

1. Скопируйте видеофайлы в папку `videos` (уже загружены)
2. Запустите скрипт:

```bash
cd test_model
python main.py
```

Скрипт последовательно обработает каждый видеофайл из папки `videos` и отправит его на сервер в двух режимах: обычном и RGB.
Для каждого режима выдаст массив глоссов, которые выдала модель.

### Тестирование векторного поиска

#### Формат файла запросов

Файл `queries.txt` должен содержать запросы в следующем формате:

```
вопрос1_первой_услуги#путь_до_услуги
вопрос2_первой_услуги#путь_до_услуги

вопрос1_второй_услуги#путь_до_услуги
вопрос2_второй_услуги#путь_до_услуги
```
Каждый вопрос пишется с новой строки, услуги для вопросов разделяются пустой строкой, вопрос и путь до услуги разделяются символом `#`.
Сейчас файл корректно заполнен, но вопросы можно править, чтоб увеличить качество выдачи результатов.

1. Подготовьте файл `queries.txt` с вашими запросами (сейчас он уже готов)
2. Запустите скрипт:

```bash
cd test_vector_find
python test_vector_find.py
```
Скрипт обработает каждый запрос из файла, выполнит поиск на сервере и выведет результаты и статистику, в формате:

`x - (путь до услуги) - Вопрос`

Где x - номер в порядке выдачи, от 1 до 4. 

1 - на первом месте выдачи, 4 - на последнем. 

0 - поиск не выдал предполагаемую услугу по этому вопросу.

На 85 строчке в скрипте test_vector_find.py можно указать какие места выводить, сейчас выводятся 0, 3 и 4.

И в конце скрипта выведет словать вида:

`{0: x, 1: y, 2: z, 3: m, 4: n}`

`{место в поиске: количество вопросов с выдачей этого места}`


